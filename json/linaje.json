[
  {
    "id": "c7b4c677-86ee-4ba0-9b5f-6536cb6bc64b",
    "consulta": "insert into sbani.dest_table (id, nombre, telefono) select t.id, t.full_name as nombre, t.phone from sbani.source_table t",
    "tabla_origen": "sbani.source_table",
    "tabla_destino": "sbani.dest_table",
    "campo_origen": "id",
    "campo_destino": "id",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping por posicion entre select y lista de columnas destino"
  },
  {
    "id": "ce5db76d-ec3c-45d4-a941-1f321721d505",
    "consulta": "insert into sbani.dest_table (id, nombre, telefono) select t.id, t.full_name as nombre, t.phone from sbani.source_table t",
    "tabla_origen": "sbani.source_table",
    "tabla_destino": "sbani.dest_table",
    "campo_origen": "full_name",
    "campo_destino": "nombre",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping por posicion entre select y lista de columnas destino"
  },
  {
    "id": "fd445e57-79ab-4f6f-9534-bf09e984ec33",
    "consulta": "insert into sbani.dest_table (id, nombre, telefono) select t.id, t.full_name as nombre, t.phone from sbani.source_table t",
    "tabla_origen": "sbani.source_table",
    "tabla_destino": "sbani.dest_table",
    "campo_origen": "phone",
    "campo_destino": "telefono",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping por posicion entre select y lista de columnas destino"
  },
  {
    "id": "163dd4ee-c0c2-435f-9b0c-a005d97e4f57",
    "consulta": "insert into sbani.dest_all select * from sbani.source_all",
    "tabla_origen": "sbani.source_all",
    "tabla_destino": "sbani.dest_all",
    "campo_origen": null,
    "campo_destino": null,
    "transformacion_aplicada": null,
    "recomendaciones": "relacion a nivel de tablas por uso de * en el select; si necesita mapping columna a columna, especificar columnas en el insert o consultar metastore"
  },
  {
    "id": "d2417ee0-4b30-4c35-aeac-132ab89a8d3d",
    "consulta": "create table sbani.ctas_table as select a.col1, b.col2 from sbani.tabla_a a join sbani.tabla_b b on a.id = b.id",
    "tabla_origen": "sbani.tabla_a",
    "tabla_destino": "sbani.ctas_table",
    "campo_origen": "col1",
    "campo_destino": "col1",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precision"
  },
  {
    "id": "73ca7b06-fe2b-4594-9ce2-0d8d2da38075",
    "consulta": "create table sbani.ctas_table as select a.col1, b.col2 from sbani.tabla_a a join sbani.tabla_b b on a.id = b.id",
    "tabla_origen": "sbani.tabla_b",
    "tabla_destino": "sbani.ctas_table",
    "campo_origen": "col2",
    "campo_destino": "col2",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precision"
  },
  {
    "id": "56c40b1c-5736-4e23-bdda-48214dd4f3fa",
    "consulta": "with cte as ( select id, valor from sbani.origen ) insert into sbani.destino select id, valor from cte",
    "tabla_origen": "cte",
    "tabla_destino": "sbani.destino",
    "campo_origen": "id",
    "campo_destino": "id",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en el insert para mayor claridad"
  },
  {
    "id": "9886048a-85cb-4902-a70f-42c2249f5582",
    "consulta": "with cte as ( select id, valor from sbani.origen ) insert into sbani.destino select id, valor from cte",
    "tabla_origen": "cte",
    "tabla_destino": "sbani.destino",
    "campo_origen": "valor",
    "campo_destino": "valor",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en el insert para mayor claridad"
  },
  {
    "id": "618cf0b2-f081-43f7-9049-6e352307182c",
    "consulta": "create table if not exists dwh.ventas_estructura like raw.ventas",
    "tabla_origen": "raw.ventas",
    "tabla_destino": "dwh.ventas_estructura",
    "campo_origen": null,
    "campo_destino": null,
    "transformacion_aplicada": null,
    "recomendaciones": "create table like: relacion a nivel de tablas"
  },
  {
    "id": "773e3756-1dd1-412d-b208-f87b15e5e1a9",
    "consulta": "insert into dwh.ventas_estructura select * from raw.ventas where fecha_venta >= '2025-01-01'",
    "tabla_origen": "raw.ventas",
    "tabla_destino": "dwh.ventas_estructura",
    "campo_origen": null,
    "campo_destino": null,
    "transformacion_aplicada": null,
    "recomendaciones": "relacion a nivel de tablas por uso de * en el select; si necesita mapping columna a columna, especificar columnas en el insert o consultar metastore"
  },
  {
    "id": "0469d059-cb84-44e1-9051-7b218c61a409",
    "consulta": "create table if not exists dwh.ventas_resumen stored as parquet as with ventas_filtradas as ( select v.cliente_id, v.producto_id, v.cantidad, v.precio, v.fecha_venta from raw.ventas v where v.fecha_venta >= '2025-01-01' ), clientes_activos as ( select c.cliente_id, c.nombre, c.segmento from mkt.clientes c where c.estado = 'activo' ) select ca.cliente_id, ca.nombre, ca.segmento, sum(vf.cantidad * vf.precio) as total_comprado, count(distinct vf.producto_id) as productos_distintos from ventas_filtradas vf join clientes_activos ca on vf.cliente_id = ca.cliente_id group by ca.cliente_id, ca.nombre, ca.segmento",
    "tabla_origen": "mkt.clientes",
    "tabla_destino": "dwh.ventas_resumen",
    "campo_origen": "cliente_id",
    "campo_destino": "cliente_id",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precision"
  },
  {
    "id": "7bb00061-05bd-49bb-8c0b-ebc7ca9f1c34",
    "consulta": "create table if not exists dwh.ventas_resumen stored as parquet as with ventas_filtradas as ( select v.cliente_id, v.producto_id, v.cantidad, v.precio, v.fecha_venta from raw.ventas v where v.fecha_venta >= '2025-01-01' ), clientes_activos as ( select c.cliente_id, c.nombre, c.segmento from mkt.clientes c where c.estado = 'activo' ) select ca.cliente_id, ca.nombre, ca.segmento, sum(vf.cantidad * vf.precio) as total_comprado, count(distinct vf.producto_id) as productos_distintos from ventas_filtradas vf join clientes_activos ca on vf.cliente_id = ca.cliente_id group by ca.cliente_id, ca.nombre, ca.segmento",
    "tabla_origen": "mkt.clientes",
    "tabla_destino": "dwh.ventas_resumen",
    "campo_origen": "nombre",
    "campo_destino": "nombre",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precision"
  },
  {
    "id": "2f6a5469-1548-4fae-8a8e-68da3694f38f",
    "consulta": "create table if not exists dwh.ventas_resumen stored as parquet as with ventas_filtradas as ( select v.cliente_id, v.producto_id, v.cantidad, v.precio, v.fecha_venta from raw.ventas v where v.fecha_venta >= '2025-01-01' ), clientes_activos as ( select c.cliente_id, c.nombre, c.segmento from mkt.clientes c where c.estado = 'activo' ) select ca.cliente_id, ca.nombre, ca.segmento, sum(vf.cantidad * vf.precio) as total_comprado, count(distinct vf.producto_id) as productos_distintos from ventas_filtradas vf join clientes_activos ca on vf.cliente_id = ca.cliente_id group by ca.cliente_id, ca.nombre, ca.segmento",
    "tabla_origen": "mkt.clientes",
    "tabla_destino": "dwh.ventas_resumen",
    "campo_origen": "segmento",
    "campo_destino": "segmento",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precision"
  },
  {
    "id": "90c1af89-532e-4616-89b6-93aa12b5bb1f",
    "consulta": "create table if not exists dwh.ventas_resumen stored as parquet as with ventas_filtradas as ( select v.cliente_id, v.producto_id, v.cantidad, v.precio, v.fecha_venta from raw.ventas v where v.fecha_venta >= '2025-01-01' ), clientes_activos as ( select c.cliente_id, c.nombre, c.segmento from mkt.clientes c where c.estado = 'activo' ) select ca.cliente_id, ca.nombre, ca.segmento, sum(vf.cantidad * vf.precio) as total_comprado, count(distinct vf.producto_id) as productos_distintos from ventas_filtradas vf join clientes_activos ca on vf.cliente_id = ca.cliente_id group by ca.cliente_id, ca.nombre, ca.segmento",
    "tabla_origen": "raw.ventas",
    "tabla_destino": "dwh.ventas_resumen",
    "campo_origen": "cantidad",
    "campo_destino": "total_comprado",
    "transformacion_aplicada": "sum(vf.cantidad * vf.precio)",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precision"
  },
  {
    "id": "b43df18e-1291-4421-9090-8afd372876e5",
    "consulta": "create table if not exists dwh.ventas_resumen stored as parquet as with ventas_filtradas as ( select v.cliente_id, v.producto_id, v.cantidad, v.precio, v.fecha_venta from raw.ventas v where v.fecha_venta >= '2025-01-01' ), clientes_activos as ( select c.cliente_id, c.nombre, c.segmento from mkt.clientes c where c.estado = 'activo' ) select ca.cliente_id, ca.nombre, ca.segmento, sum(vf.cantidad * vf.precio) as total_comprado, count(distinct vf.producto_id) as productos_distintos from ventas_filtradas vf join clientes_activos ca on vf.cliente_id = ca.cliente_id group by ca.cliente_id, ca.nombre, ca.segmento",
    "tabla_origen": "raw.ventas",
    "tabla_destino": "dwh.ventas_resumen",
    "campo_origen": "precio",
    "campo_destino": "total_comprado",
    "transformacion_aplicada": "sum(vf.cantidad * vf.precio)",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precision"
  },
  {
    "id": "edf5d85e-2c5c-4fe2-92b8-56ea8ab6a6a8",
    "consulta": "create table if not exists dwh.ventas_resumen stored as parquet as with ventas_filtradas as ( select v.cliente_id, v.producto_id, v.cantidad, v.precio, v.fecha_venta from raw.ventas v where v.fecha_venta >= '2025-01-01' ), clientes_activos as ( select c.cliente_id, c.nombre, c.segmento from mkt.clientes c where c.estado = 'activo' ) select ca.cliente_id, ca.nombre, ca.segmento, sum(vf.cantidad * vf.precio) as total_comprado, count(distinct vf.producto_id) as productos_distintos from ventas_filtradas vf join clientes_activos ca on vf.cliente_id = ca.cliente_id group by ca.cliente_id, ca.nombre, ca.segmento",
    "tabla_origen": "raw.ventas",
    "tabla_destino": "dwh.ventas_resumen",
    "campo_origen": "producto_id",
    "campo_destino": "productos_distintos",
    "transformacion_aplicada": "count(distinct vf.producto_id)",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precision"
  },
  {
    "id": "e662d9a8-2a94-45b9-8225-16e8bf3e2c6d",
    "consulta": "create table if not exists ventas_resumen stored as parquet as with ventas_filtradas as ( select cliente_id, producto_id, cantidad, precio, fecha_venta from ventas where fecha_venta >= '2025-01-01' ), totales_por_cliente as ( select cliente_id, sum(cantidad * precio) as total_comprado, count(distinct producto_id) as productos_distintos from ventas_filtradas group by cliente_id ) select c.cliente_id, c.total_comprado, c.productos_distintos, current_timestamp() as fecha_proceso from totales_por_cliente c",
    "tabla_origen": "ventas",
    "tabla_destino": "ventas_resumen",
    "campo_origen": "cliente_id",
    "campo_destino": "cliente_id",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precision"
  },
  {
    "id": "3fc45a8d-212a-41c6-b967-bfda488dbb4a",
    "consulta": "create table if not exists ventas_resumen stored as parquet as with ventas_filtradas as ( select cliente_id, producto_id, cantidad, precio, fecha_venta from ventas where fecha_venta >= '2025-01-01' ), totales_por_cliente as ( select cliente_id, sum(cantidad * precio) as total_comprado, count(distinct producto_id) as productos_distintos from ventas_filtradas group by cliente_id ) select c.cliente_id, c.total_comprado, c.productos_distintos, current_timestamp() as fecha_proceso from totales_por_cliente c",
    "tabla_origen": "ventas",
    "tabla_destino": "ventas_resumen",
    "campo_origen": "total_comprado",
    "campo_destino": "total_comprado",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precision"
  },
  {
    "id": "c929501a-911c-46fd-b043-b041c55734df",
    "consulta": "create table if not exists ventas_resumen stored as parquet as with ventas_filtradas as ( select cliente_id, producto_id, cantidad, precio, fecha_venta from ventas where fecha_venta >= '2025-01-01' ), totales_por_cliente as ( select cliente_id, sum(cantidad * precio) as total_comprado, count(distinct producto_id) as productos_distintos from ventas_filtradas group by cliente_id ) select c.cliente_id, c.total_comprado, c.productos_distintos, current_timestamp() as fecha_proceso from totales_por_cliente c",
    "tabla_origen": "ventas",
    "tabla_destino": "ventas_resumen",
    "campo_origen": "productos_distintos",
    "campo_destino": "productos_distintos",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precision"
  },
  {
    "id": "eb255d9a-f150-44f2-847c-07149854d3e4",
    "consulta": "create table if not exists ventas_resumen stored as parquet as with ventas_filtradas as ( select cliente_id, producto_id, cantidad, precio, fecha_venta from ventas where fecha_venta >= '2025-01-01' ), totales_por_cliente as ( select cliente_id, sum(cantidad * precio) as total_comprado, count(distinct producto_id) as productos_distintos from ventas_filtradas group by cliente_id ) select c.cliente_id, c.total_comprado, c.productos_distintos, current_timestamp() as fecha_proceso from totales_por_cliente c",
    "tabla_origen": "funciones",
    "tabla_destino": "ventas_resumen",
    "campo_origen": "current_timestamp()",
    "campo_destino": "fecha_proceso",
    "transformacion_aplicada": "current_timestamp()",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precision"
  }
]