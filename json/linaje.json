[
  {
    "id": "192267d1-52bd-42bb-8fb8-785d6fd25bb9",
    "consulta": "insert into sbani.dest_table (id, nombre, telefono) select t.id, t.full_name as nombre, t.phone from sbani.source_table t",
    "tabla_origen": "sbani.source_table",
    "tabla_destino": "sbani.dest_table",
    "campo_origen": "id",
    "campo_destino": "id",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping por posicion entre select y lista de columnas destino"
  },
  {
    "id": "2c26f119-6a34-4725-a514-b8a290485a45",
    "consulta": "insert into sbani.dest_table (id, nombre, telefono) select t.id, t.full_name as nombre, t.phone from sbani.source_table t",
    "tabla_origen": "sbani.source_table",
    "tabla_destino": "sbani.dest_table",
    "campo_origen": "full_name",
    "campo_destino": "nombre",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping por posicion entre select y lista de columnas destino"
  },
  {
    "id": "2825c16e-2bc8-4515-9df6-43b90f45b164",
    "consulta": "insert into sbani.dest_table (id, nombre, telefono) select t.id, t.full_name as nombre, t.phone from sbani.source_table t",
    "tabla_origen": "sbani.source_table",
    "tabla_destino": "sbani.dest_table",
    "campo_origen": "phone",
    "campo_destino": "telefono",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping por posicion entre select y lista de columnas destino"
  },
  {
    "id": "85db11bd-63d6-4db4-9786-dee802a1c7a4",
    "consulta": "insert into sbani.dest_all select * from sbani.source_all",
    "tabla_origen": "sbani.source_all",
    "tabla_destino": "sbani.dest_all",
    "campo_origen": null,
    "campo_destino": null,
    "transformacion_aplicada": null,
    "recomendaciones": "relacion a nivel de tablas por uso de * en el select; si necesita mapping columna a columna, especificar columnas en el insert o consultar metastore"
  },
  {
    "id": "2eee447b-6553-46e7-9f6d-e85175d633fe",
    "consulta": "create table sbani.ctas_table as select a.col1, b.col2 from sbani.tabla_a a join sbani.tabla_b b on a.id = b.id",
    "tabla_origen": "sbani.tabla_a",
    "tabla_destino": "sbani.ctas_table",
    "campo_origen": "col1",
    "campo_destino": "col1",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precisiã³n"
  },
  {
    "id": "6dd9278a-b642-4cf0-9c9a-a3f7ea5a5957",
    "consulta": "create table sbani.ctas_table as select a.col1, b.col2 from sbani.tabla_a a join sbani.tabla_b b on a.id = b.id",
    "tabla_origen": "sbani.tabla_b",
    "tabla_destino": "sbani.ctas_table",
    "campo_origen": "col2",
    "campo_destino": "col2",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precisiã³n"
  },
  {
    "id": "1a003c91-a4dd-481b-a917-0951752dd2b9",
    "consulta": "with cte as ( select id, valor from sbani.origen ) insert into sbani.destino select id, valor from cte",
    "tabla_origen": "cte",
    "tabla_destino": "sbani.destino",
    "campo_origen": "id",
    "campo_destino": "id",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en el insert para mayor claridad"
  },
  {
    "id": "231c2751-a59a-4dc0-abbb-6ab7c432ea8e",
    "consulta": "with cte as ( select id, valor from sbani.origen ) insert into sbani.destino select id, valor from cte",
    "tabla_origen": "cte",
    "tabla_destino": "sbani.destino",
    "campo_origen": "valor",
    "campo_destino": "valor",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en el insert para mayor claridad"
  },
  {
    "id": "55e53216-8d0d-4b59-b93f-2a707fcc3454",
    "consulta": "create table if not exists dwh.ventas_estructura like raw.ventas",
    "tabla_origen": "raw.ventas",
    "tabla_destino": "dwh.ventas_estructura",
    "campo_origen": null,
    "campo_destino": null,
    "transformacion_aplicada": null,
    "recomendaciones": "create table like: relacion a nivel de tablas"
  },
  {
    "id": "29736c49-febb-4d16-bcb6-8a51a0697b1d",
    "consulta": "insert into dwh.ventas_estructura select * from raw.ventas where fecha_venta >= '2025-01-01'",
    "tabla_origen": "raw.ventas",
    "tabla_destino": "dwh.ventas_estructura",
    "campo_origen": null,
    "campo_destino": null,
    "transformacion_aplicada": null,
    "recomendaciones": "relacion a nivel de tablas por uso de * en el select; si necesita mapping columna a columna, especificar columnas en el insert o consultar metastore"
  },
  {
    "id": "7b4169a3-11fc-452e-acd6-085867e0393d",
    "consulta": "create table if not exists dwh.ventas_resumen stored as parquet as with ventas_filtradas as ( select v.cliente_id, v.producto_id, v.cantidad, v.precio, v.fecha_venta from raw.ventas v where v.fecha_venta >= '2025-01-01' ), clientes_activos as ( select c.cliente_id, c.nombre, c.segmento from mkt.clientes c where c.estado = 'activo' ) select ca.cliente_id, ca.nombre, ca.segmento, sum(vf.cantidad * vf.precio) as total_comprado, count(distinct vf.producto_id) as productos_distintos from ventas_filtradas vf join clientes_activos ca on vf.cliente_id = ca.cliente_id group by ca.cliente_id, ca.nombre, ca.segmento",
    "tabla_origen": "raw.ventas",
    "tabla_destino": "dwh.ventas_resumen",
    "campo_origen": null,
    "campo_destino": null,
    "transformacion_aplicada": null,
    "recomendaciones": "relacion a nivel de tablas (ctas sin lista de campos o uso de *) - verificar esquema en metastore si necesita mapping columna a columna"
  },
  {
    "id": "40e3b9da-4827-4ff9-be05-78b20c1ceb7f",
    "consulta": "create table if not exists dwh.ventas_resumen stored as parquet as with ventas_filtradas as ( select v.cliente_id, v.producto_id, v.cantidad, v.precio, v.fecha_venta from raw.ventas v where v.fecha_venta >= '2025-01-01' ), clientes_activos as ( select c.cliente_id, c.nombre, c.segmento from mkt.clientes c where c.estado = 'activo' ) select ca.cliente_id, ca.nombre, ca.segmento, sum(vf.cantidad * vf.precio) as total_comprado, count(distinct vf.producto_id) as productos_distintos from ventas_filtradas vf join clientes_activos ca on vf.cliente_id = ca.cliente_id group by ca.cliente_id, ca.nombre, ca.segmento",
    "tabla_origen": "mkt.clientes",
    "tabla_destino": "dwh.ventas_resumen",
    "campo_origen": null,
    "campo_destino": null,
    "transformacion_aplicada": null,
    "recomendaciones": "relacion a nivel de tablas (ctas sin lista de campos o uso de *) - verificar esquema en metastore si necesita mapping columna a columna"
  },
  {
    "id": "c07f2c26-9267-4eae-8658-8df28a26c926",
    "consulta": "create table if not exists ventas_resumen stored as parquet as with ventas_filtradas as ( select cliente_id, producto_id, cantidad, precio, fecha_venta from ventas where fecha_venta >= '2025-01-01' ), totales_por_cliente as ( select cliente_id, sum(cantidad * precio) as total_comprado, count(distinct producto_id) as productos_distintos from ventas_filtradas group by cliente_id ) select c.cliente_id, c.total_comprado, c.productos_distintos, current_timestamp() as fecha_proceso from totales_por_cliente c",
    "tabla_origen": "ventas",
    "tabla_destino": "ventas_resumen",
    "campo_origen": "cliente_id",
    "campo_destino": "cliente_id",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precisiã³n"
  },
  {
    "id": "9a9c9918-d184-4edd-9fdd-f6035134b2fb",
    "consulta": "create table if not exists ventas_resumen stored as parquet as with ventas_filtradas as ( select cliente_id, producto_id, cantidad, precio, fecha_venta from ventas where fecha_venta >= '2025-01-01' ), totales_por_cliente as ( select cliente_id, sum(cantidad * precio) as total_comprado, count(distinct producto_id) as productos_distintos from ventas_filtradas group by cliente_id ) select c.cliente_id, c.total_comprado, c.productos_distintos, current_timestamp() as fecha_proceso from totales_por_cliente c",
    "tabla_origen": "ventas",
    "tabla_destino": "ventas_resumen",
    "campo_origen": "total_comprado",
    "campo_destino": "total_comprado",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precisiã³n"
  },
  {
    "id": "4f28158c-ec2e-4f2f-8386-0fc7ea577f9b",
    "consulta": "create table if not exists ventas_resumen stored as parquet as with ventas_filtradas as ( select cliente_id, producto_id, cantidad, precio, fecha_venta from ventas where fecha_venta >= '2025-01-01' ), totales_por_cliente as ( select cliente_id, sum(cantidad * precio) as total_comprado, count(distinct producto_id) as productos_distintos from ventas_filtradas group by cliente_id ) select c.cliente_id, c.total_comprado, c.productos_distintos, current_timestamp() as fecha_proceso from totales_por_cliente c",
    "tabla_origen": "ventas",
    "tabla_destino": "ventas_resumen",
    "campo_origen": "productos_distintos",
    "campo_destino": "productos_distintos",
    "transformacion_aplicada": "copy",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precisiã³n"
  },
  {
    "id": "0dad8c50-0652-46fa-9965-77954f2af883",
    "consulta": "create table if not exists ventas_resumen stored as parquet as with ventas_filtradas as ( select cliente_id, producto_id, cantidad, precio, fecha_venta from ventas where fecha_venta >= '2025-01-01' ), totales_por_cliente as ( select cliente_id, sum(cantidad * precio) as total_comprado, count(distinct producto_id) as productos_distintos from ventas_filtradas group by cliente_id ) select c.cliente_id, c.total_comprado, c.productos_distintos, current_timestamp() as fecha_proceso from totales_por_cliente c",
    "tabla_origen": "ventas",
    "tabla_destino": "ventas_resumen",
    "campo_origen": "current_timestamp",
    "campo_destino": "fecha_proceso",
    "transformacion_aplicada": "current_timestamp()",
    "recomendaciones": "mapping inferido sin lista destino; se recomienda especificar columnas en create table (...) as select (...) para mayor precisiã³n"
  }
]